# Music-Recommendation-System
Use machine learning algorithm to recommend music for users based on the data from Kagggle competition
### 1.Introducion
This project is mainly for the course artificial intelligence in PHBS which is a final project. Our team including 5 people who are Karlie, Genie, Simon, Lobby and me. They all have tried their best to contribute for the project during the busy exam week in PHBS.<br>
If you are not interested in this English documents, you can download the Chinese pdf file.<br>
We wanted to use machine learning algorithm to implement the music recommendation system and we found that there was a competition in Kaggle which was already finished (https://www.kaggle.com/c/kkbox-music-recommendation-challenge/data). Under this circumstance, we use the data from the kaggle generated from the web pages of KKBOX. The data include train.csv, test.csv, members.csv, song.csv and song_extra_ino.csv which could be downloaded directly from kaggle. If you want to run the codes you should download all the data and put them in the file data/raw. We have tried several algorithm including logistic regression, GBDT, xgboost and lightGBM to fit the data. <br>
### 2.EDA and feature engineering
AII the python file have detailed notes so that you can understand it well. <br>
(1)The 0-split-data-set.py is to read the train.csv and separate it to train dataset and test dataset. Because our computers have limited RAM and calculation capabilities, we can not process the original data which has 9,000,000 pieces of listening records in total. Therefore, we just select 500,000 pieces of listening records randomly from the original data as train and test dataset. We select 20% of the subsample as test dataset and 80% as training dataset.<br>
(2)1-train-test-process.py is to process the training and test dataset generated from the first python file. The dataset only contains listening records including user id, music id, source_system_tabs, ource_screen_name, source_type (listening resources) and target which means that whether the user listen the music again in one month. Because there are a lot of missing values in those three sources features and there seem to be some relationships between them, we use decesion tree to fill the missing value according two another two features. This method is only for cases where there is only one missing value. For the cases where there are two or three missing value in these three features we just fill them by a empty string. We also create a new feature by combine these three features according to some other people's method.<br>
(3)2-user-process.py is to process the members.csv file. It includes user id, city, age(bd), gender, registered method, registered data and expiration date. We fill the missing values and change some features format which I will not explain in detail because they are easy to understand in the code file.<br>
(4)3-song-process.py is to process the songs.csv file. It includes the song id, genre id, language, name, artist name, lyricist, composer and ISRC code which is in the song_extra_info.csv file. There are more than one genre id of one song and they are separated by "|". We first split them to three genre ids and fill the missing values by the mode of artist_name, lyricist, composer grouping. For the ISRC, we extract the first two uppercase letters from ISRC as the region of the music.<br>
(5)4-merge-process.py is to combine these three dataframe according to the user id and music id in the training dataset. We delete some features according to the feature importance calculated by random forest (In the feature-importance.py). The category variables are changed to numerical variables by factorize function in pandas. The user id, music id, artist name, composer, name are all deleted because there are too many categories in them. We also create some conditional probability features according to other people's method.<br>
### 3.Model


